<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FahadFlix</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  background: #141414;
  color: #fff;
  min-height: 100vh;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.container { max-width: 1100px; margin: 18px auto; padding: 12px; }

/* AUTH PAGE */
.auth-box {
  max-width: 420px;
  margin: 10vh auto;
  padding: 40px 30px;
  background: rgba(0,0,0,0.85);
  border-radius: 6px;
  text-align: center;
  box-shadow: 0 0 20px rgba(0,0,0,0.6);
}
.auth-box input,
.auth-box button {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 6px;
  border: none;
}
.auth-box input {
  background: #333;
  border: 1px solid #555;
  color: #fff;
}
.auth-box button {
  background: #e50914;
  color: #fff;
  font-weight: 700;
  cursor: pointer;
  transition: background 0.2s;
}
.auth-box button:hover { background: #f6121d; }

/* PAGE TOGGLING */
.page { display: none; }
.active { display: block; }

h1,h2 { margin: 14px 0; text-align: center; }

/* PROFILES PAGE */
#profilesContainer {
  display: flex;
  flex-wrap: wrap;
  gap: 18px;
  justify-content: center;
  margin-top: 20px;
}
.profile-card {
  width: 160px;
  background: transparent;
  padding: 8px;
  text-align: center;
}
.profile-card img {
  width: 100%;
  height: 160px;
  object-fit: cover;
  border-radius: 8px;
  cursor: pointer;
  transition: transform 0.25s;
}
.profile-card img:hover { transform: scale(1.08); }
.profile-card p { margin-top: 8px; font-size: 14px; }
.profile-card button { margin-top: 4px; width: 100%; padding: 4px 0; font-size: 12px; }

/* BUTTONS */
.btn {
  padding: 8px 12px;
  background: #e50914;
  border: none;
  border-radius: 6px;
  color: #fff;
  cursor: pointer;
  transition: background 0.2s;
}
.btn:hover { background: #f6121d; }
.btn.ghost {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.3);
}
.btn.ghost:hover {
  background: rgba(255,255,255,0.1);
}

/* ADD AREA */
.add-area {
  max-width: 520px;
  margin: 18px auto;
  padding: 12px;
  background: #161616;
  border-radius: 8px;
  display: flex;
  gap: 8px;
  align-items: center;
}
.add-area input[type="text"],
.add-area input[type="file"],
.add-area select {
  flex: 1;
  padding: 10px;
  border-radius: 6px;
  border: none;
  background: #222;
  color: #fff;
}
.add-area button {
  padding: 10px 12px;
  background: #e50914;
  border: none;
  color: #fff;
  border-radius: 6px;
  cursor: pointer;
}

/* MOVIES & ROWS */
#moviesContainer { display: flex; flex-direction: column; gap: 20px; padding: 12px; }
.row {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding: 10px 0;
}
.row::-webkit-scrollbar { display: none; }
.movie-card {
  flex: 0 0 auto;
  width: 200px;
  background: #1d1d1d;
  border-radius: 8px;
  overflow: hidden;
  position: relative;
  cursor: pointer;
  transition: transform 0.25s;
}
.movie-card:hover {
  transform: scale(1.05);
  z-index: 5;
}
.movie-card img {
  width: 100%;
  height: 300px;
  object-fit: cover;
}
.movie-card .title {
  position: absolute;
  bottom: 8px;
  left: 8px;
  font-size: 14px;
  background: rgba(0,0,0,0.6);
  padding: 4px 8px;
  border-radius: 4px;
}

/* EPISODES */
.episode-card {
  background: #1f1f1f;
  padding: 12px;
  border-radius: 8px;
  cursor: pointer;
  margin-bottom: 8px;
}

/* PLAYER */
#player { margin: 20px auto; text-align: center; }
video {
  width: 95%;
  max-width: 980px;
  border-radius: 8px;
  background: #000;
}
.controls {
  display: flex;
  gap: 8px;
  justify-content: center;
  margin-top: 12px;
}

/* SEARCH */
#searchInput {
  width: 100%;
  padding: 10px;
  margin: 12px 0;
  border-radius: 6px;
  border: none;
  background: #222;
  color: #fff;
}

/* RESPONSIVE */
@media(max-width:600px){
  .add-area { flex-direction: column; align-items: stretch; }
  .movie-card img { height: 180px; }
  .profile-card img { height: 100px; }
}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-database-compat.js"></script>
</head>
<body>
<div class="container">

<!-- AUTH PAGE -->
<div id="authPage" class="page active">
  <div class="auth-box">
    <h2>Login or Sign Up</h2>
    <input id="email" type="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password">
    <button id="signInBtn">Sign In</button>
    <button id="signUpBtn" class="btn ghost">Sign Up</button>
  </div>
</div>

<!-- PROFILES PAGE -->
<div id="profilesPage" class="page">
  <h1>Who's watching?</h1>
  <div class="add-area">
    <input id="newProfileName" type="text" placeholder="New profile name">
    <input id="newProfileImage" type="file" accept="image/*">
    <button id="addProfileBtn">Add</button>
  </div>
  <div id="profilesContainer"></div>
  <div style="text-align:center;margin-top:12px">
    <button id="signOutBtn" class="btn ghost">Sign Out</button>
  </div>
</div>

<!-- HOME PAGE -->
<div id="homePage" class="page">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <h1 id="welcomeTitle">Browse</h1>
    <div style="display:flex;gap:8px;align-items:center">
      <button id="switchProfileBtn" class="btn ghost">Switch Profile</button>
      <button id="logoutBtn" class="btn">Logout</button>
      <button id="adminToggleBtn" class="btn ghost" style="display:none">Admin Panel</button>
    </div>
  </div>
  <input id="searchInput" type="text" placeholder="Search movies or shows...">
  <div id="moviesContainer"></div>
</div>

<!-- EPISODES PAGE -->
<div id="episodesPage" class="page">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <h1 id="showTitle">Show</h1>
    <button id="backToHome" class="btn ghost">Back</button>
  </div>
  <div id="episodesContainer"></div>
</div>

<!-- PLAYER PAGE -->
<div id="playerPage" class="page">
  <h1 id="playerTitle">Player</h1>
  <div id="player">
    <video id="videoPlayer" controls crossorigin="anonymous"></video>
  </div>
  <div class="controls">
    <button class="btn" id="toggleSubsBtn">Toggle Subtitles</button>
    <button class="btn ghost" id="playerBackBtn">Back</button>
  </div>
</div>

<!-- ADMIN PAGE -->
<div id="adminPage" class="page">
  <h1>Admin Panel</h1>
  <div class="add-area">
    <input id="adminTitle" type="text" placeholder="Title">
    <input id="adminImg" type="text" placeholder="Image URL">
    <input id="adminSrc" type="text" placeholder="Video URL">
    <input id="adminSubs" type="text" placeholder="Subtitles URL (optional)">
    <select id="adminType">
      <option value="movies">Movie</option>
      <option value="shows">Show</option>
    </select>
    <button id="addMediaBtn">Add Media</button>
  </div>
  <div id="adminList"></div>
  <button id="saveToGithubBtn" class="btn">Save Changes to GitHub</button>
  <button onclick="showPage('home')" class="btn ghost">Back</button>
</div>

</div>

<script>
// ================== Firebase Config ================== //
const firebaseConfig = {
  apiKey: "AIzaSyCvd_IgPL3_gYjhfplngBboHWjSLRIhhIE",
  authDomain: "fahadflix-storage.firebaseapp.com",
  databaseURL: "https://fahadflix-storage-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "fahadflix-storage",
  storageBucket: "fahadflix-storage.appspot.com",
  messagingSenderId: "1064833913945",
  appId: "1:1064833913945:web:bf711e8b364fcfdf2b8d48"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth(), db=firebase.database();
let currentUser=null, profiles=[], mediaData={movies:[], shows:[]};

// ================== Page Toggling ================== //
function showPage(id) {
  document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
  document.getElementById(id + "Page").classList.add("active");
}

// ================== Auth Handlers ================== //
document.getElementById("signUpBtn").addEventListener("click", () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  auth.createUserWithEmailAndPassword(email, password)
    .then(userCredential => {
      currentUser = userCredential.user;
      console.log("Signed up:", currentUser.email);
      showPage("profiles");
    })
    .catch(err => alert(err.message));
});

document.getElementById("signInBtn").addEventListener("click", () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  auth.signInWithEmailAndPassword(email, password)
    .then(userCredential => {
      currentUser = userCredential.user;
      console.log("Signed in:", currentUser.email);
      showPage("profiles");
    })
    .catch(err => alert(err.message));
});

document.getElementById("signOutBtn").addEventListener("click", () => {
  auth.signOut().then(() => { currentUser = null; showPage("auth"); });
});
document.getElementById("logoutBtn").addEventListener("click", () => {
  auth.signOut().then(() => { currentUser = null; showPage("auth"); });
});

// Auto redirect if user is already logged in
auth.onAuthStateChanged(user => {
  if (user) {
    currentUser = user;
    showPage("profiles");
    if (user.email === "fxhdle2@gmail.com") {
      document.getElementById("adminToggleBtn").style.display = "inline-block";
    }
  } else {
    showPage("auth");
  }
});
</script>
</body>
</html>
