<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FahadFlix</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* keep all your styles, I only adjusted profiles */
...
/* ===== MERGED PROFILES INSIDE HOME ===== */
#profilesInline {margin:16px 0;display:flex;flex-wrap:wrap;gap:16px;justify-content:center;}
.profile-card{width:120px;text-align:center;background:#1b1b1b;padding:10px;border-radius:10px;cursor:pointer;transition:0.25s;}
.profile-card:hover{transform:scale(1.05);}
.profile-card img{width:100px;height:100px;border-radius:50%;object-fit:cover;}
.profile-card p{margin:6px 0;font-weight:600;font-size:14px;}
</style>

<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-database-compat.js"></script>
</head>
<body>
<div class="container">

<!-- AUTH PAGE -->
<div id="authPage" class="page active">
  <div class="auth-box">
    <h2>Login or Sign Up</h2>
    <input id="email" type="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password">
    <button id="signInBtn" class="btn">Sign In</button>
    <button id="signUpBtn" class="btn ghost">Sign Up</button>
  </div>
</div>

<!-- HOME PAGE (with profiles merged) -->
<div id="homePage" class="page">
  <div class="header">
    <h1 id="welcomeTitle">Browse</h1>
    <div class="btn-group">
      <button id="logoutBtn" class="btn">Logout</button>
      <button id="adminToggleBtn" class="btn ghost" style="display:none">Admin Panel</button>
    </div>
  </div>

  <!-- INLINE PROFILE SELECTION -->
  <h2>Who's watching?</h2>
  <div id="profilesInline"></div>
  <div class="add-area">
    <input id="newProfileName" type="text" placeholder="New profile name">
    <input id="newProfileImage" type="file" accept="image/*">
    <button id="addProfileBtn">Add</button>
  </div>

  <input id="searchInput" type="text" placeholder="Search movies or shows...">
  <div id="moviesContainer"></div>
</div>

<!-- PLAYER PAGE -->
<div id="playerPage" class="page">
  <h1 id="playerTitle">Player</h1>
  <div id="player"><video id="videoPlayer" controls crossorigin="anonymous"></video></div>
  <div class="controls">
    <button class="btn ghost" id="playerBackBtn">Back</button>
  </div>
</div>

</div>

<script>
// ===== FIREBASE =====
const firebaseConfig = {
  apiKey:"AIzaSyCvd_IgPL3_gYjhfplngBboHWjSLRIhhIE",
  authDomain:"fahadflix-storage.firebaseapp.com",
  databaseURL:"https://fahadflix-storage-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId:"fahadflix-storage",
  storageBucket:"fahadflix-storage.appspot.com",
  messagingSenderId:"1064833913945",
  appId:"1:1064833913945:web:bf711e8b364fcfdf2b8d48"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth(), db=firebase.database();

let currentUser=null, profiles=[], mediaData={movies:[],shows:[]}, activeProfile=null;

const pages={auth:document.getElementById('authPage'),home:document.getElementById('homePage'),player:document.getElementById('playerPage')};
function showPage(n){Object.values(pages).forEach(p=>p.classList.remove('active'));pages[n].classList.add('active');}

// ===== AUTH =====
document.getElementById('signInBtn').onclick=()=>auth.signInWithEmailAndPassword(email.value,password.value).catch(console.error);
document.getElementById('signUpBtn').onclick=()=>auth.createUserWithEmailAndPassword(email.value,password.value).catch(console.error);
document.getElementById('logoutBtn').onclick=()=>auth.signOut();

auth.onAuthStateChanged(user=>{
  if(user){currentUser=user;loadProfiles();}
  else{showPage('auth');}
});

// ===== PROFILES (INLINE) =====
function loadProfiles(){
  db.ref('profiles/'+currentUser.uid).once('value').then(snap=>{
    profiles=snap.val()?Object.values(snap.val()):[];
    renderProfiles();
    showPage('home');
    loadMedia();
  });
}

function renderProfiles(){
  const container=document.getElementById('profilesInline');
  container.innerHTML='';
  profiles.forEach((p,i)=>{
    const card=document.createElement('div');card.className='profile-card';
    card.innerHTML=`<img src="${p.img}" alt=""><p>${p.name}</p>`;
    card.onclick=()=>{
      activeProfile=p;
      welcomeTitle.textContent="Welcome, "+p.name;
    };
    container.appendChild(card);
  });
}
document.getElementById('addProfileBtn').onclick=()=>{
  const name=newProfileName.value,file=newProfileImage.files[0];
  if(!name||!file)return;
  const reader=new FileReader();
  reader.onload=()=>{profiles.push({name,img:reader.result});saveProfiles();renderProfiles();}
  reader.readAsDataURL(file);
};
function saveProfiles(){db.ref('profiles/'+currentUser.uid).set(profiles);}

// ===== MEDIA =====
async function loadMedia(){
  try{
    const res=await fetch('https://fahadflix.netlify.app/movies.json');
    if(!res.ok)throw new Error('fetch failed');
    mediaData=await res.json();
    renderMedia();
  }catch(e){console.error(e);}
}
function renderMedia(){
  const container=moviesContainer;container.innerHTML='';
  ['movies','shows'].forEach(cat=>{
    if(mediaData[cat].length){
      const sec=document.createElement('div');
      sec.innerHTML=`<h2 class="section-title">${cat}</h2>`;
      const row=document.createElement('div');row.className='row';
      mediaData[cat].forEach(m=>{
        const card=document.createElement('div');card.className='movie-card';
        card.innerHTML=`<img src="${m.img}"><div class="title">${m.title}</div>`;
        card.onclick=()=>openPlayer(m);
        row.appendChild(card);
      });
      sec.appendChild(row);container.appendChild(sec);
    }
  });
}

// ===== PLAYER =====
function openPlayer(m){showPage('player');videoPlayer.src=m.src;playerTitle.textContent=m.title;}
playerBackBtn.onclick=()=>showPage('home');
</script>
</body>
</html>
